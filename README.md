# Лабораторная работа №2: Мини-оболочка (Mini Shell)

## Что это такое?

Это простая командная строка, похожая на ту, что используется в Linux или Windows. Она позволяет работать с файлами и
папками прямо из терминала.

## Структура проекта

```
.
├── src/                    # Здесь весь основной код
│   ├── commands/           # Каждая команда в отдельном файле
│   │   ├── cmd_cat.py     # Показ содержимого файла
│   │   ├── cmd_cd.py      # Переход в папку
│   │   ├── cmd_cp.py      # Копирование
│   │   ├── cmd_grep.py    # Поиск текста в файлах
│   │   ├── cmd_ls.py      # Список файлов
│   │   ├── cmd_mv.py      # Перемещение/переименование
│   │   ├── cmd_rm.py      # Удаление
│   │   ├── cmd_tar.py     # Создание tar.gz архива
│   │   ├── cmd_untar.py   # Распаковка tar.gz
│   │   ├── cmd_zip.py     # Создание zip архива
│   │   └── cmd_unzip.py   # Распаковка zip
│   ├── mini_shell.py      # Главная логика работы оболочки
│   ├── history.py         # История команд
│   └── main.py            # Точка входа (здесь всё начинается)
├── tests/                 # Тесты для проверки работы команд
└── README.md              # Эта инструкция
```

## Как запустить

### Обычный запуск

```bash
python -m src.main
```

После запуска вы увидите приглашение командной строки, например:

```
C:\Users\svlad\Desktop> 
```

### Запуск из определённой папки

Можно сразу начать работу из нужной папки:

```bash
python -m src.main Documents
```

### Выход из программы

Чтобы закончить работу, введите:

- `exit` или `q`
- Или нажмите `Ctrl+D` (на Linux/Mac) или `Ctrl+Z` (на Windows)

## Доступные команды

### cd - перейти в папку

Просто меняет текущую папку.

**Как использовать:**

```
cd Documents      # Перейти в папку Documents
cd ..             # Вернуться на уровень выше
cd ~              # Перейти в домашнюю папку
cd                # То же самое, что и cd ~
```

---

### ls - посмотреть что в папке

Показывает список файлов и папок.

**Обычный список:**

```
ls                # Список файлов в текущей папке
ls Documents      # Список файлов в папке Documents
```

**Подробный список (с флагом -l):**

```
ls -l             # Показать права доступа, размер и дату изменения
ls -l Documents   # То же самое для конкретной папки
```

**Особенность:** Скрытые файлы (начинающиеся с точки) и `desktop.ini` не показываются.

---

### cat - показать содержимое файла

Выводит на экран весь текст из файла.

```
cat file.txt
cat Documents/readme.txt
```

---

### cp - скопировать файл или папку

Копирует файлы и папки.

**Для файлов:**

```
cp file.txt copy.txt              # Скопировать файл
cp file.txt Documents/            # Скопировать файл в папку
```

**Для папок (нужен флаг -r):**

```
cp -r folder backup_folder        # Скопировать всю папку со всем содержимым
```

**Особенность:** Флаг `-r` можно написать в любом месте:

```
cp -r folder backup      # Правильно
cp folder -r backup      # Тоже правильно!
```

---

### mv - переместить или переименовать

Перемещает файл/папку или переименовывает.

```
mv old.txt new.txt                # Переименовать файл
mv file.txt Documents/            # Переместить файл в папку
mv folder new_folder              # Переименовать/переместить папку
```

---

### rm - удалить файл или папку

Удаляет файлы и папки.

**Для файлов:**

```
rm file.txt                       # Удалить файл
```

**Для папок (нужен флаг -r):**

```
rm -r folder                      # Удалить папку
```

**Важные особенности:**

- Файлы не удаляются навсегда, а перемещаются в корзину `~/.trash`
- При удалении папки программа спросит подтверждение: `Удалить каталог 'folder' со всем содержимым? (y/n):`
- Если в корзине уже есть файл с таким именем, создаётся уникальное имя (например, `file_1`, `file_2`)

---

### grep - найти текст в файлах

Ищет нужный текст в файлах. Можно использовать регулярные выражения Python.

**Простой поиск:**

```
grep "hello" file.txt             # Найти слово "hello" в файле
```

**Поиск без учёта регистра (флаг -i):**

```
grep -i "ERROR" log.txt           # Найдёт "error", "ERROR", "Error" и т.д.
```

**Поиск во всех файлах папки (флаг -r):**

```
grep -r "function" src/           # Искать слово "function" во всех файлах папки src/
```

**Можно комбинировать флаги:**

```
grep -r -i "test" folder          # Поиск "test" во всех файлах без учёта регистра
grep -i -r "test" folder          # То же самое, порядок не важен!
```

---

### tar - создать tar.gz архив

Создаёт сжатый архив из папки.

```
tar Documents archive.tar.gz      # Создать архив из папки Documents
tar project backup.tar.gz         # Создать архив проекта
```

---

### untar - распаковать tar.gz архив

Распаковывает tar.gz архив в текущую папку.

```
untar archive.tar.gz
untar backup.tar.gz
```

---

### zip - создать ZIP архив

Создаёт ZIP архив из папки.

```
zip Documents archive.zip         # Создать ZIP архив
zip project project.zip           # Архивировать проект
```

---

### unzip - распаковать ZIP архив

Распаковывает ZIP архив в текущую папку.

```
unzip archive.zip
unzip backup.zip
```

---

### history - история команд

Показывает список последних выполненных команд.

```
history                            # Показать последние 10 команд
```

**Особенность:** Хранится максимум последних 10 команд. Если вы выполнили больше команд, покажутся только последние 10.

---

### undo - отменить последнюю команду

Отменяет действие последней команды (если это возможно).

```
undo                               # Отменить последнюю команду
```

**Поддерживается для:**

- `cp` - удалит скопированный файл
- `mv` - вернёт файл на место
- `rm` - восстановит удалённый файл из корзины

**Важно:** Отменяется только одна последняя команда. После повторного вызова `undo` отменится предыдущая команда.

---

## Особенности работы моей программы

### 1. Скрытые файлы не показываются

Команда `ls` автоматически скрывает:

- Файлы, начинающиеся с точки (например, `.gitignore`, `.env`)
- Файл `desktop.ini` (системный файл Windows)

Это сделано для удобства - обычно такие файлы не нужны при работе.

### 2. Безопасное удаление

При удалении файлов командой `rm` они не удаляются навсегда, а переносятся в корзину:

- Путь к корзине: `~/.trash` (в домашней папке пользователя)
- Если файл с таким именем уже есть в корзине, создаётся уникальное имя: `file_1`, `file_2`, `file_3` и так далее

### 3. Подтверждение удаления папок

При попытке удалить папку командой `rm -r` программа спросит подтверждение:

```
Удалить каталог 'folder' со всем содержимым? (y/n):
```

Нужно ввести `y` для подтверждения или `n` для отмены.

### 4. История команд ограничена

Команда `history` хранит только последние введённые команды.

### 5. Поиск работает с регулярными выражениями

Команда `grep`:

```
grep "test" file.txt          # Найти "test" в file.txt 
```

### 6. Логирование всех действий

Все команды записываются в файл `shell.log` для отслеживания работы.

### 7. Поддержка относительных путей

Все команды понимают относительные пути:

- `.` - текущая папка
- `..` - родительская папка
- `~/Documents` - тильда означает домашнюю папку

---
